## 안전한 소프트웨어 개발 방법론 (8월 8일)

1. 시큐어 코딩의 개요
   - 소프트웨어 개발 보안의 필요성
   - 침해 사고 사례
   - 보안취약점 정보 활용
   - 행정자치부 소프트웨어 개발보안 가이드



1) 인증 여부 체크 - 

지식: 내가 알고 있는 것(비밀번호 등)

소유: 내가 갖고 있는 것(카드 키 등) 

특징: 내 특징(지문, 홍채 등)

2) 처리를 위한 정보가 전달 여부

3) Select * from 고객 where 고객번호 =

4) 결과 반환



-- 위 방법은 인가(Authorization)이 안되고 있음

- 화면
- 기능 
- Data

------

개발 보안을 하면 ~~

1) 인증 / 인가

2) 입력 값 검증 



#### 파일업로드 취약점

파일 업로드 기능을 제고하는 사이트에서

업로드 파일의 **크기와 개수**를 제한하지 않거나,

- 서버의 연결 및 디스크 자원을 고갈시킨다. => 정상적인 서비스를 방해 => DoS 

업로드 파일의 종류를 제한하지 않거나,

- 서버에서 실행 가능한 웹쉘(WebShell) 파일을 업로드 후 해당 파일을 실행해서 서버의 제어권을 탈취
- 악성코드가 포함된 실행 파일을 업로드 후 불특정 다수가 다운로드하도록 유도

외부에서 접근 가능한 경로에 파일을 저장하는 경우에 발생하는 취약점



##### 방어기법

- 업로드 파일의 크기와 개수를 제한한다.
- 업로드 파일의 종류를 제한한다.
- 외부에서 접근할 수 없는 경로에 업로드 파일을 저장
- 업로드 파일의 저장 경로와 파일명을 외부에서 알 수 없도록 한다.
- 업로드  파일의 실행 속성을 제거한 후 저장한다. 



보안사고 사례

계정관리 미비, 암호화 정책 미비, 업로드 취약점, 관제 시스템 



하트 블리드 취약점 

- Heartbeat Request의 Length를 조작해서 



취약점DB

1. CWE: 미국 국토안보부에서 관리
2. CVE
3. SANS Top 25
4. OWASP Top 10



SQL 명령에 사용된 특별한 엘리먼트를 무효화하지 않는 것 (SQL InJection)

SQL문 예약어 또는 특수기호 => 메타문자(어떤 기능에서 의미를 가지고 있는 문자)

이스케이프 = 메타문자(의미문자)에서 의미를 제거하고 문자만 남기는 것



**SQL Injection**

외부 입력값을 쿼리 조작 문자열  포함 여부를 확인하지 않고,

쿼리 생성 및 실행에 사용하는 경우 발생

-> 원래 의미와 다른 형태로 쿼리가 변형되어서 실행되는 것

```sql
select * from user where id = 123;
// id 컬럼의 값이 1234일 user 테이블에 정보를 조회
select * from user where id=123 or 1=1; 
// user 테이블의 모든 정보를 조회
```



**운영체제 명령어 삽입(Command Injection)**

운영체제 명령어 실행 부분이 존재하는 경우,

외부 입력값을 검증, 제한하지 않고, 명령어 또는 명령어의 일부로 사용하는 경우 발생

> 외부 입력값을 검증 제한하지 않고 명령어로 사용하는 경우
>
> => 명령어가 실행된다.  

```java
String cmd = request.getParameter("cmd");
Runtime.getRuntime().exec(cmd); 
```

> 외부 입력값을 검증, 제한하지 않고, 명령어의 일부로 사용하는 경우
>
> => 의도하지 않은 추가 명령어 실행이 가능 

```java
String file = request.getParameter("file");
Runtime.getRuntime().exec("type c:\\data\\" + file);
```

파일의 내용을 콘솔에 출력



**크로스 사이트 스크립팅(XSS = Cross-site Scripting)**

웹 페이지 생성에 사용된 입력값 검증이 이뤄지지 않은 것

동적 페이지 / 입력값이 페이지 생성에 사용되었음

​						입력값에 실행 가능한 코드가 포함되었음

공격자가 전달한 스크립트 코드가 사용자 브라우저를 통해서 실행되는 것

1) 저장 XSS (Stored)

**2) 반사 XSS (Reflective)**

--> 1) 희생자 브라우저 또는 PC의 정보를 탈취

​	2) 가짜 페이지를 만들어 사용자로 하여금 입력을 유도해서 입력 정보를 탈취

​	3) 원격지에서 해당 PC를 제어 = 좀비화 => BeEF



방어법: 

1) 입력값 검증: 오류처리하든지, 제거하든지 

2) 입력값을 포함된 태그 요소(< >)를 HTML 인코딩 처리해서 출력한다.



**사이트간 요청위조 = 크로스 사이트 요청위조 = CSRF(Cross-Site Request Forgery)**

요청을 받은 서버측 프로그램이, 요청 주체와 요청 절차를 검증하지 않고 요청을 처리했을 때 발생



CORS가 뭐인가요? SOP 정책을 완화시켜주는거에요...



CSP => Content Security policy